---
/**
 * 文章版权信息组件
 * 显示在每篇博文底部
 */
import { SITE_AUTHOR, SITE_URL } from "@/config/site.config";
import { Separator } from "@/components/ui/separator";
import { t, type Locale } from "@/i18n";

interface Props {
  title: string;
  author?: string;
  pubDate: Date;
  locale?: Locale;
}

const { title, author = SITE_AUTHOR, pubDate, locale = 'zh-CN' } = Astro.props;
const postUrl = new URL(Astro.url.pathname, SITE_URL).href;
const year = pubDate.getFullYear();
const currentYear = new Date().getFullYear();
const yearDisplay = year === currentYear ? `${year}` : `${year}-${currentYear}`;
---

<Separator className="my-8" />

<aside class="bg-muted/50 rounded-lg p-6 text-sm">
  <h4 class="font-semibold mb-3 text-base">{t('copyright.title', locale)}</h4>
  
  <dl class="space-y-2 text-muted-primary">
    <div class="flex flex-wrap gap-x-2">
      <dt class="font-medium text-foreground">{t('copyright.postTitle', locale)}</dt>
      <dd>{title}</dd>
    </div>
    
    <div class="flex flex-wrap gap-x-2">
      <dt class="font-medium text-foreground">{t('copyright.postAuthor', locale)}</dt>
      <dd>{author}</dd>
    </div>
    
    <div class="flex flex-wrap gap-x-2">
      <dt class="font-medium text-foreground">{t('copyright.postLink', locale)}</dt>
      <dd>
        <a href={postUrl} class="hover:underline break-all">
          {postUrl}
        </a>
      </dd>
    </div>
    
    <div class="flex flex-wrap gap-x-2">
      <dt class="font-medium text-foreground">{t('copyright.license', locale)}</dt>
      <dd>
        <p
          set:html={t('copyright.licenseText', locale, {
            license: `<a 
                        href="https://creativecommons.org/licenses/by-nc-sa/4.0/" 
                        target="_blank" 
                        rel="noopener noreferrer"
                        class="hover:underline"
                      >
                        CC BY-NC-SA 4.0</a>`,
          })}></p>
      </dd>
    </div>
  </dl>
  
  <p class="mt-4 text-xs text-muted-foreground/70">
    © {yearDisplay} {author}. {t('copyright.rightsReserved', locale)}.
  </p>
</aside>
